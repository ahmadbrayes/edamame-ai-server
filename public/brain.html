<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Edamame Brain</title>

  <style>

:root{
  --bg:#efe1cf;                 /* beige */
  --card:#ffffff;
  --text:#2b2b2b;
  --muted:#6b6b6b;

  --primary:#8db600;           /* edamame green */
  --secondary:#a79ad6;         /* lavender */

  --line:rgba(0,0,0,.08);
  --radius:18px;
  --shadow:0 10px 30px rgba(0,0,0,.06);
}

/* ===== BODY ===== */

body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background: var(--bg);
  color:var(--text);
}


/* ===== WRAP ===== */

.wrap{
  max-width:1200px;   /* wider = more premium */
  margin:auto;
  height:100vh;
  display:flex;
  flex-direction:column;
  padding:20px;
  box-sizing:border-box;
}


/* ===== HEADER ===== */

header{
  background: rgba(255,255,255,.65);
  backdrop-filter: blur(14px);
  border:1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:16px 18px;
  display:flex;
  align-items:center;
  gap:10px;
}

header b{
  color:var(--primary);
  font-size:18px;
  letter-spacing:.3px;
}

header span{
  color:var(--muted);
  font-size:13px;
}


/* ===== CHAT BOX ===== */

.chat{
  flex:1;
  overflow:auto;
  margin-top:16px;
  background:var(--card);
  border-radius: var(--radius);
  border:1px solid var(--line);
  box-shadow: var(--shadow);
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:14px;
}


/* ===== MESSAGES ===== */

.msg{
  max-width:72%;
  padding:14px 16px;
  border-radius:16px;
  line-height:1.6;
  font-size:14.5px;
  white-space: pre-wrap;
}


/* USER */

.me{
  align-self:flex-end;
  background: rgba(141,182,0,.12);
  border:1px solid rgba(141,182,0,.35);
}


/* AI */

.ai{
  align-self:flex-start;
  background:#ffffff;
  border:1px solid rgba(0,0,0,.07);
}


/* ===== INPUT BAR ===== */

.bar{
  margin-top:16px;
  background:var(--card);
  border-radius: var(--radius);
  border:1px solid var(--line);
  box-shadow: var(--shadow);
  padding:12px;
  display:flex;
  gap:12px;
  align-items:flex-end;
}


/* ===== TEXTAREA ===== */

textarea{
  flex:1;
  resize:none;
  height:60px;
  border-radius:16px;
  border:1px solid rgba(0,0,0,.12);
  background:#fff;
  color:var(--text);
  padding:14px;
  font-size:14.5px;
  outline:none;
}

textarea:focus{
  border-color: var(--primary);
  box-shadow:0 0 0 4px rgba(141,182,0,.15);
}


/* ===== BUTTON ===== */

button{
  width:140px;
  height:60px;
  border-radius:16px;
  border:0;
  cursor:pointer;
  color:#fff;
  font-weight:600;
  font-size:15px;

  background: linear-gradient(
    135deg,
    #8db600,
    #a79ad6
  );

  box-shadow:0 10px 25px rgba(0,0,0,.12);
  transition:.18s;
}

button:hover{
  transform:translateY(-2px);
}

button:disabled{
  opacity:.6;
  cursor:not-allowed;
  transform:none;
  box-shadow:none;
}

</style>


</head>
<body>
  <div class="wrap">
    <header>
      <b>Edamame Brain</b>
      <span>Smart. Bold. Deep strategy.</span>
    </header>

    <div id="chat" class="chat"></div>

    <div class="bar">
      <textarea id="input" placeholder="Type here..."></textarea>
      <button id="send">Send</button>
    </div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("input");
    const send = document.getElementById("send");

    function makeId() {
      return "s_" + Date.now().toString(36) + "_" + Math.random().toString(36).slice(2);
    }

    let sessionId = localStorage.getItem("sessionId");
    if (!sessionId) {
      sessionId = makeId();
      localStorage.setItem("sessionId", sessionId);
    }

    function addMsg(text, cls){
      const d = document.createElement("div");
      d.className = "msg " + cls;
      d.textContent = text;
      chat.appendChild(d);
      chat.scrollTop = chat.scrollHeight;
      return d;
    }

    async function ask(){
      const text = input.value.trim();
      if(!text) return;

      input.value = "";
      send.disabled = true;

      addMsg(text, "me");
      const waiting = addMsg("...", "ai");

      try{
        const r = await fetch("/api/chat", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ message: text, sessionId })
        });

        const data = await r.json();
        waiting.textContent = data.reply || "No response.";
      }catch(e){
        waiting.textContent = "Connection error. Try again.";
      }finally{
        send.disabled = false;
        input.focus();
      }
    }

    send.addEventListener("click", ask);
    input.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" && !e.shiftKey){
        e.preventDefault();
        ask();
      }
    });

    addMsg("Edamame Content Brain. Tell me what you sell — and I’ll help you create content that drives attention.", "ai");
  </script>
</body>
</html>