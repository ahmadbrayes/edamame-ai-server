<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Edamame Brain</title>
  <style>
    body{margin:0;font-family:system-ui;background:#0b0b0f;color:#fff}
    .wrap{max-width:980px;margin:0 auto;height:100vh;display:flex;flex-direction:column}
    header{padding:16px 18px;border-bottom:1px solid #222;display:flex;align-items:center;gap:10px}
    header b{font-size:18px}
    header span{opacity:.7;font-size:12px}
    .chat{flex:1;overflow:auto;padding:18px;display:flex;flex-direction:column;gap:12px}
    .msg{max-width:82%;padding:12px 14px;border-radius:14px;line-height:1.6;white-space:pre-wrap}
    .me{align-self:flex-start;background:#1c1c26;border:1px solid #2b2b36}
    .ai{align-self:flex-end;background:#0f2a1b;border:1px solid #1f5a3a}
    .bar{display:flex;gap:10px;padding:14px;border-top:1px solid #222}
    textarea{flex:1;resize:none;height:54px;border-radius:12px;border:1px solid #2b2b36;background:#111118;color:#fff;padding:10px 12px;outline:none}
    button{width:120px;border-radius:12px;border:none;background:#5b5bff;color:#fff;font-weight:700;cursor:pointer}
    button:disabled{opacity:.5;cursor:not-allowed}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <b>Edamame Brain</b>
      <span>Smart. Bold. Deep strategy.</span>
    </header>

    <div id="chat" class="chat"></div>

    <div class="bar">
      <textarea id="input" placeholder="Type here..."></textarea>
      <button id="send">Send</button>
    </div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    const input = document.getElementById("input");
    const send = document.getElementById("send");

    function addMsg(text, cls){
      const d = document.createElement("div");
      d.className = "msg " + cls;
      d.textContent = text;
      chat.appendChild(d);
      chat.scrollTop = chat.scrollHeight;
      return d;
    }

    async function ask(){
      const text = input.value.trim();
      if(!text) return;
      input.value = "";
      send.disabled = true;

      addMsg(text, "me");
      const waiting = addMsg("...", "ai");

      try{
        const r = await fetch("/api/chat", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ message: text })
        });
        const data = await r.json();
        waiting.textContent = data.reply || JSON.stringify(data);
      }catch(e){
        waiting.textContent = "Error. Please try again.";
      }finally{
        send.disabled = false;
        input.focus();
      }
    }

    send.addEventListener("click", ask);
    input.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" && !e.shiftKey){
        e.preventDefault();
        ask();
      }
    });

    addMsg("Edamame Brain here. Whatâ€™s your business type, which city, and which platform matters most?", "ai");
  </script>
</body>
</html>
